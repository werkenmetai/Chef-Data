---
/**
 * Feedback Improvement Page
 *
 * Shown after negative feedback submission (NPS 1-6)
 */
import Layout from '../../layouts/Layout.astro';

const score = Astro.url.searchParams.get('score');
const token = Astro.url.searchParams.get('token');
const npsScore = score ? parseInt(score, 10) : null;
---

<Layout title="Help ons verbeteren">
  <div class="min-h-[60vh] flex items-center justify-center px-4">
    <div class="max-w-md w-full">
      <!-- Header -->
      <div class="text-center mb-6">
        <div class="w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
          </svg>
        </div>

        <h1 class="text-2xl font-bold text-gray-900 mb-2">
          We willen verbeteren
        </h1>

        {npsScore !== null && (
          <p class="text-gray-600">
            Je gaf een {npsScore} van 10. Dat kan beter - help ons begrijpen hoe.
          </p>
        )}
      </div>

      <!-- Feedback Form -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <form action="/api/feedback/improvement" method="POST" class="space-y-5">
          <input type="hidden" name="token" value={token} />
          <input type="hidden" name="nps_score" value={npsScore} />

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-3">
              Waar loop je tegenaan?
            </label>
            <div class="space-y-2">
              <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                <input type="radio" name="improvement_category" value="setup" class="text-exact-blue focus:ring-exact-blue" />
                <div>
                  <span class="text-sm font-medium text-gray-900">Moeilijk in te stellen</span>
                  <p class="text-xs text-gray-500">De configuratie of koppeling is te complex</p>
                </div>
              </label>

              <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                <input type="radio" name="improvement_category" value="accuracy" class="text-exact-blue focus:ring-exact-blue" />
                <div>
                  <span class="text-sm font-medium text-gray-900">Antwoorden niet accuraat</span>
                  <p class="text-xs text-gray-500">De AI geeft incorrecte of misleidende informatie</p>
                </div>
              </label>

              <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                <input type="radio" name="improvement_category" value="features" class="text-exact-blue focus:ring-exact-blue" />
                <div>
                  <span class="text-sm font-medium text-gray-900">Mist functionaliteit</span>
                  <p class="text-xs text-gray-500">Ik heb features nodig die er nog niet zijn</p>
                </div>
              </label>

              <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                <input type="radio" name="improvement_category" value="speed" class="text-exact-blue focus:ring-exact-blue" />
                <div>
                  <span class="text-sm font-medium text-gray-900">Te langzaam</span>
                  <p class="text-xs text-gray-500">Responses duren te lang</p>
                </div>
              </label>

              <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                <input type="radio" name="improvement_category" value="price" class="text-exact-blue focus:ring-exact-blue" />
                <div>
                  <span class="text-sm font-medium text-gray-900">Te duur</span>
                  <p class="text-xs text-gray-500">De prijs weegt niet op tegen de waarde</p>
                </div>
              </label>

              <label class="flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors">
                <input type="radio" name="improvement_category" value="other" class="text-exact-blue focus:ring-exact-blue" />
                <div>
                  <span class="text-sm font-medium text-gray-900">Anders</span>
                  <p class="text-xs text-gray-500">Iets anders dat niet hierboven staat</p>
                </div>
              </label>
            </div>
          </div>

          <div>
            <label for="details" class="block text-sm font-medium text-gray-700 mb-1">
              Vertel meer (optioneel)
            </label>
            <textarea
              id="details"
              name="feedback_text"
              rows="4"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-exact-blue focus:border-transparent focus:outline-none resize-none"
              placeholder="Hoe specifieker, hoe beter we kunnen helpen..."
            ></textarea>
          </div>

          <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <label class="flex items-start gap-2 cursor-pointer">
              <input
                type="checkbox"
                name="contact_me"
                value="1"
                class="mt-1 rounded border-blue-300 text-blue-600 focus:ring-blue-500"
              />
              <div>
                <span class="text-sm font-medium text-blue-900">Neem contact met me op</span>
                <p class="text-xs text-blue-700">We bellen of mailen je om te helpen met je probleem</p>
              </div>
            </label>
          </div>

          <button
            type="submit"
            class="w-full px-4 py-3 bg-exact-blue text-white font-semibold rounded-lg hover:bg-exact-dark transition-colors"
          >
            Versturen
          </button>
        </form>
      </div>

      <div class="mt-6 text-center">
        <a href="/dashboard" class="text-sm text-gray-500 hover:text-gray-700">
          ‚Üê Terug naar Dashboard
        </a>
      </div>
    </div>
  </div>
</Layout>
